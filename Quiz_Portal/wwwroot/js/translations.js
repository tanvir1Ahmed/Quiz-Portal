// Translations for English and Arabic
const translations = {
    en: {
        // Common
        appName: "Bangladesh Quiz Portal",
        quizMaster: "Quiz Master",
        home: "Home",
        quiz: "Quiz",
        leaderboard: "Leaderboard",
        login: "Login",
        logout: "Logout",
        signUp: "Sign Up",
        
        // Index Page
        getStarted: "Get Started",
        joinNow: "Join now and test your knowledge!",
        welcomeBack: "Welcome Back!",
        readyToTest: "Hello, {name}! Ready to test your knowledge?",
        takeQuiz: "Take Quiz",
        viewLeaderboard: "View Leaderboard",
        questions: "20 Questions",
        testKnowledge: "Test your knowledge",
        timer: "10s Timer",
        perQuestion: "Per question",
        competeWin: "Compete & win",
        
        // Login Page
        welcomeBackTitle: "Welcome Back",
        loginContinue: "Login to continue your quiz",
        phoneNumber: "Phone Number",
        enterPhone: "Enter your 10 digit registered phone number",
        loginBtn: "Login",
        pleaseWait: "Please wait...",
        loginFailed: "Login failed. Please try again.",
        errorOccurred: "An error occurred. Please try again.",
        noAccount: "Don't have an account?",
        signUpHere: "Sign up here",
        
        // SignUp Page
        createAccount: "Create Account",
        joinPortal: "Join Bangladesh Quiz Portal",
        fullName: "Full Name",
        enterFullName: "Enter your full name",
        enterPhoneDigits: "Enter 10 digit phone number",
        signUpBtn: "Sign Up",
        redirecting: "Redirecting to login...",
        alreadyHaveAccount: "Already have an account?",
        loginHere: "Login here",
        
        // Quiz Page
        loginRequired: "Login Required",
        pleaseLogin: "Please login to take the quiz.",
        goToLogin: "Go to Login",
        testKnowledge20: "Test your knowledge with 20 questions!",
        perQuestionBadge: "10s per question",
        competeWinBadge: "Compete & win",
        startQuiz: "Start Quiz",
        questionOf: "Question {current} of {total}",
        correct: "Correct",
        wrong: "Wrong",
        timeout: "Timeout",
        quizComplete: "Quiz Complete!",
        outOf20: "out of 20 correct",
        rank: "Rank",
        
        // Feedback Messages
        excellent: "Excellent!",
        youNailedIt: "You nailed it!",
        onFire: "On Fire!",
        keepGoing: "Keep it going!",
        brilliant: "Brilliant!",
        youreStar: "You're a star!",
        awesome: "Awesome!",
        rocketing: "Rocketing to success!",
        perfect: "Perfect!",
        unstoppable: "You're unstoppable!",
        champion: "Champion!",
        impressive: "That was impressive!",
        spectacular: "Spectacular!",
        simplyAmazing: "Simply amazing!",
        bullseye: "Bullseye!",
        rightOnTarget: "Right on target!",
        oops: "Oops!",
        betterLuck: "Better luck next time!",
        notQuite: "Not Quite!",
        keepTrying: "Keep trying!",
        close: "Close!",
        getNextOne: "You'll get the next one!",
        learnGrow: "Learn & Grow!",
        mistakeLesson: "Every mistake is a lesson!",
        timesUp: "Time's Up!",
        beQuicker: "Be quicker next time!",
        tooSlow: "Too Slow!",
        speedUp: "Speed up!",
        
        // Leaderboard Page
        leaderboardTitle: "Leaderboard",
        topPerformers: "Top performers in Bangladesh Quiz",
        yourRank: "Your Rank",
        top50: "Top 50",
        loadingLeaderboard: "Loading leaderboard...",
        failedToLoad: "Failed to load. Please refresh.",
        noResultsYet: "No results yet. Be the first!",
        wantToSeeHere: "Want to see your name here?",
        
        // Footer
        copyright: "© 2026 - Quiz Master",
        
        // Loading
        loading: "Loading...",
        loadingQuestions: "Loading questions...",
        failedLoadQuestions: "Failed to load questions. Please refresh the page.",
        
        // Placeholders
        enterFullNamePlaceholder: "Enter your full name"
    },
    ar: {
        // Common
        appName: "بوابة اختبار بنغلاديش",
        quizMaster: "سيد الاختبار",
        home: "الرئيسية",
        quiz: "الاختبار",
        leaderboard: "لوحة المتصدرين",
        login: "تسجيل الدخول",
        logout: "تسجيل الخروج",
        signUp: "إنشاء حساب",
        
        // Index Page
        getStarted: "ابدأ الآن",
        joinNow: "انضم الآن واختبر معلوماتك!",
        welcomeBack: "مرحباً بعودتك!",
        readyToTest: "مرحباً، {name}! هل أنت مستعد لاختبار معلوماتك؟",
        takeQuiz: "ابدأ الاختبار",
        viewLeaderboard: "عرض لوحة المتصدرين",
        questions: "20 سؤال",
        testKnowledge: "اختبر معلوماتك",
        timer: "10 ثواني",
        perQuestion: "لكل سؤال",
        competeWin: "تنافس واربح",
        
        // Login Page
        welcomeBackTitle: "مرحباً بعودتك",
        loginContinue: "سجل الدخول للمتابعة في الاختبار",
        phoneNumber: "رقم الهاتف",
        enterPhone: "أدخل رقم هاتفك المسجل المكون من 10 أرقام",
        loginBtn: "تسجيل الدخول",
        pleaseWait: "يرجى الانتظار...",
        loginFailed: "فشل تسجيل الدخول. يرجى المحاولة مرة أخرى.",
        errorOccurred: "حدث خطأ. يرجى المحاولة مرة أخرى.",
        noAccount: "ليس لديك حساب؟",
        signUpHere: "سجل هنا",
        
        // SignUp Page
        createAccount: "إنشاء حساب",
        joinPortal: "انضم إلى بوابة اختبار بنغلاديش",
        fullName: "الاسم الكامل",
        enterFullName: "أدخل اسمك الكامل",
        enterPhoneDigits: "أدخل رقم الهاتف المكون من 10 أرقام",
        signUpBtn: "إنشاء حساب",
        redirecting: "جاري التحويل لتسجيل الدخول...",
        alreadyHaveAccount: "لديك حساب بالفعل؟",
        loginHere: "سجل الدخول هنا",
        
        // Quiz Page
        loginRequired: "تسجيل الدخول مطلوب",
        pleaseLogin: "يرجى تسجيل الدخول للمشاركة في الاختبار.",
        goToLogin: "الذهاب لتسجيل الدخول",
        testKnowledge20: "اختبر معلوماتك مع 20 سؤالاً!",
        perQuestionBadge: "10 ثواني لكل سؤال",
        competeWinBadge: "تنافس واربح",
        startQuiz: "ابدأ الاختبار",
        questionOf: "السؤال {current} من {total}",
        correct: "صحيح",
        wrong: "خطأ",
        timeout: "انتهى الوقت",
        quizComplete: "انتهى الاختبار!",
        outOf20: "من 20 إجابة صحيحة",
        rank: "الترتيب",
        
        // Feedback Messages
        excellent: "ممتاز!",
        youNailedIt: "أحسنت!",
        onFire: "رائع جداً!",
        keepGoing: "استمر!",
        brilliant: "مبهر!",
        youreStar: "أنت نجم!",
        awesome: "مذهل!",
        rocketing: "في طريقك للنجاح!",
        perfect: "مثالي!",
        unstoppable: "لا يمكن إيقافك!",
        champion: "بطل!",
        impressive: "كان هذا مثيراً للإعجاب!",
        spectacular: "رائع!",
        simplyAmazing: "مدهش ببساطة!",
        bullseye: "إصابة مباشرة!",
        rightOnTarget: "في الهدف تماماً!",
        oops: "عفواً!",
        betterLuck: "حظ أفضل في المرة القادمة!",
        notQuite: "ليس تماماً!",
        keepTrying: "استمر في المحاولة!",
        close: "قريب!",
        getNextOne: "ستحصل على السؤال التالي!",
        learnGrow: "تعلم وتطور!",
        mistakeLesson: "كل خطأ هو درس!",
        timesUp: "انتهى الوقت!",
        beQuicker: "كن أسرع في المرة القادمة!",
        tooSlow: "بطيء جداً!",
        speedUp: "أسرع!",
        
        // Leaderboard Page
        leaderboardTitle: "لوحة المتصدرين",
        topPerformers: "أفضل اللاعبين في اختبار بنغلاديش",
        yourRank: "ترتيبك",
        top50: "أفضل 50",
        loadingLeaderboard: "جاري تحميل لوحة المتصدرين...",
        failedToLoad: "فشل التحميل. يرجى التحديث.",
        noResultsYet: "لا توجد نتائج بعد. كن الأول!",
        wantToSeeHere: "تريد أن ترى اسمك هنا؟",
        
        // Footer
        copyright: "© 2026 - سيد الاختبار",
        
        // Loading
        loading: "جاري التحميل...",
        loadingQuestions: "جاري تحميل الأسئلة...",
        failedLoadQuestions: "فشل تحميل الأسئلة. يرجى تحديث الصفحة.",
        
        // Placeholders
        enterFullNamePlaceholder: "أدخل اسمك الكامل"
    }
};

// Language management
function getCurrentLanguage() {
    return localStorage.getItem('quizLanguage') || 'en';
}

function setLanguage(lang) {
    localStorage.setItem('quizLanguage', lang);
    applyLanguage(lang);
}

function toggleLanguage() {
    const currentLang = getCurrentLanguage();
    const newLang = currentLang === 'en' ? 'ar' : 'en';
    setLanguage(newLang);
}

function t(key, replacements = {}) {
    const lang = getCurrentLanguage();
    let text = translations[lang][key] || translations['en'][key] || key;
    
    // Replace placeholders like {name} with actual values
    Object.keys(replacements).forEach(placeholder => {
        text = text.replace(`{${placeholder}}`, replacements[placeholder]);
    });
    
    return text;
}

function applyLanguage(lang) {
    const html = document.documentElement;
    
    // Set RTL for Arabic
    if (lang === 'ar') {
        html.setAttribute('dir', 'rtl');
        html.setAttribute('lang', 'ar');
        document.body.classList.add('rtl');
    } else {
        html.setAttribute('dir', 'ltr');
        html.setAttribute('lang', 'en');
        document.body.classList.remove('rtl');
    }
    
    // Update language toggle button text
    const langBtn = document.getElementById('langToggleBtn');
    if (langBtn) {
        langBtn.innerHTML = lang === 'en' 
            ? '<i class="fas fa-language me-1"></i>العربية' 
            : '<i class="fas fa-language me-1"></i>English';
    }
    
    // Update all elements with data-translate attribute
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        const text = t(key);
        
        if (element.tagName === 'INPUT' && element.hasAttribute('placeholder')) {
            element.setAttribute('placeholder', text);
        } else {
            element.textContent = text;
        }
    });
    
    // Update all elements with data-translate-placeholder attribute
    document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
        const key = element.getAttribute('data-translate-placeholder');
        element.setAttribute('placeholder', t(key));
    });
    
    // Update all elements with data-translate-html attribute (for innerHTML)
    document.querySelectorAll('[data-translate-html]').forEach(element => {
        const key = element.getAttribute('data-translate-html');
        element.innerHTML = t(key);
    });
    
    // Update page title
    const pageTitle = document.querySelector('title');
    if (pageTitle) {
        const titleKey = pageTitle.getAttribute('data-translate-title');
        if (titleKey) {
            pageTitle.textContent = t(titleKey) + ' - ' + t('appName');
        }
    }
    
    // Dispatch custom event for page-specific updates
    window.dispatchEvent(new CustomEvent('languageChanged', { detail: { language: lang } }));
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', function() {
    const lang = getCurrentLanguage();
    applyLanguage(lang);
});
